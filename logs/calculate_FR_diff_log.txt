2025-06-10 13:51:06 - ==================================================
2025-06-10 13:51:06 - 開始計算資金費率差異
2025-06-10 13:51:06 - 參數: symbol=None, start_date=2025-06-06, end_date=2025-06-07
2025-06-10 13:51:06 - 交易所: ['binance', 'bybit']
2025-06-10 13:51:06 - ⚠️ 數據庫中沒有符合條件的資金費率歷史數據
2025-06-10 13:51:06 - ❌ 沒有可用的資金費率歷史數據，程序結束
2025-06-10 13:56:35 - ==================================================
2025-06-10 13:56:35 - 開始計算資金費率差異
2025-06-10 13:56:35 - 參數: symbol=BTCUSDT, start_date=2024-12-10, end_date=2024-12-10
2025-06-10 13:56:35 - 交易所: ['binance', 'bybit']
2025-06-10 13:56:35 - ✅ 從數據庫讀取到 24 條資金費率歷史記錄
2025-06-10 13:56:35 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 13:56:35 - 計算 binance vs bybit 的資金費率差異
2025-06-10 13:56:35 - ⚠️ binance 或 bybit 的數據為空，跳過此交易所對
2025-06-10 13:56:35 - ⚠️ 沒有計算出任何差異數據
2025-06-10 13:56:35 - ❌ 沒有計算出差異數據，程序結束
2025-06-10 13:56:51 - ==================================================
2025-06-10 13:56:51 - 開始計算資金費率差異
2025-06-10 13:56:51 - 參數: symbol=BTCUSDT, start_date=2024-12-10, end_date=2024-12-10
2025-06-10 13:56:51 - 交易所: ['binance', 'bybit']
2025-06-10 13:56:51 - ✅ 從數據庫讀取到 48 條資金費率歷史記錄
2025-06-10 13:56:51 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 13:56:51 - 計算 binance vs bybit 的資金費率差異
2025-06-10 13:56:51 - ✅ 計算完成 binance vs bybit: 24 條差異記錄
2025-06-10 13:56:51 - ✅ 總共計算出 24 條資金費率差異記錄
2025-06-10 13:56:51 - ✅ 成功保存 24 條差異記錄到數據庫
2025-06-10 13:56:51 - ✅ 資金費率差異計算完成，共保存 24 條記錄
2025-06-10 13:56:51 - ==================================================
2025-06-10 14:57:09 - ==================================================
2025-06-10 14:57:09 - 開始計算資金費率差異
2025-06-10 14:57:09 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 14:57:09 - 交易所: ['binance', 'bybit']
2025-06-10 14:57:09 - ✅ 從數據庫讀取到 48 條資金費率歷史記錄
2025-06-10 14:57:09 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 14:57:09 - 計算 binance vs bybit 的資金費率差異
2025-06-10 14:57:09 - ✅ 計算完成 binance vs bybit: 24 條差異記錄
2025-06-10 14:57:09 - ✅ 總共計算出 24 條資金費率差異記錄
2025-06-10 14:57:09 - ✅ 成功保存 24 條差異記錄到數據庫
2025-06-10 14:57:09 - ✅ 資金費率差異計算完成，共保存 24 條記錄
2025-06-10 14:57:09 - ==================================================
2025-06-10 16:02:07 - ==================================================
2025-06-10 16:02:07 - 開始計算資金費率差異
2025-06-10 16:02:07 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:02:07 - 交易所: ['binance', 'bybit']
2025-06-10 16:02:07 - ⚠️ 數據庫中沒有符合條件的資金費率歷史數據
2025-06-10 16:02:07 - ❌ 沒有可用的資金費率歷史數據，程序結束
2025-06-10 16:03:56 - ==================================================
2025-06-10 16:03:56 - 開始計算資金費率差異
2025-06-10 16:03:56 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:03:56 - 交易所: ['binance', 'bybit']
2025-06-10 16:03:56 - ✅ 從數據庫讀取到 72 條資金費率歷史記錄
2025-06-10 16:03:56 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:03:56 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:03:56 - ⚠️ binance 或 bybit 的數據為空，跳過此交易所對
2025-06-10 16:03:56 - ⚠️ 沒有計算出任何差異數據
2025-06-10 16:03:56 - ❌ 沒有計算出差異數據，程序結束
2025-06-10 16:20:00 - ==================================================
2025-06-10 16:20:00 - 開始計算資金費率差異
2025-06-10 16:20:00 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:20:00 - 交易所: ['binance', 'bybit']
2025-06-10 16:20:00 - ✅ 從數據庫讀取到 144 條資金費率歷史記錄
2025-06-10 16:20:00 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:20:00 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:20:00 - ✅ 計算完成 binance vs bybit: 72 條差異記錄
2025-06-10 16:20:00 - ✅ 總共計算出 72 條資金費率差異記錄
2025-06-10 16:20:00 - ✅ 成功保存 72 條差異記錄到數據庫
2025-06-10 16:20:00 - ✅ 資金費率差異計算完成，共保存 72 條記錄
2025-06-10 16:20:00 - ==================================================
2025-06-10 16:30:17 - ==================================================
2025-06-10 16:30:17 - 開始計算資金費率差異
2025-06-10 16:30:17 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:30:17 - 交易所: ['binance', 'bybit']
2025-06-10 16:30:17 - ✅ 從數據庫讀取到 432 條資金費率歷史記錄
2025-06-10 16:30:17 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:30:17 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:30:17 - ✅ 計算完成 binance vs bybit: 216 條差異記錄
2025-06-10 16:30:17 - ✅ 總共計算出 216 條資金費率差異記錄
2025-06-10 16:30:17 - ✅ 成功保存 216 條差異記錄到數據庫
2025-06-10 16:30:17 - ✅ 資金費率差異計算完成，共保存 216 條記錄
2025-06-10 16:30:17 - ==================================================
2025-06-10 16:42:08 - ==================================================
2025-06-10 16:42:08 - 開始計算資金費率差異
2025-06-10 16:42:08 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:42:08 - 交易所: ['binance', 'bybit']
2025-06-10 16:42:08 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:42:08 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:42:08 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:42:08 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:42:08 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:42:08 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:42:08 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:42:08 - ==================================================
2025-06-10 16:43:16 - ==================================================
2025-06-10 16:43:16 - 開始計算資金費率差異
2025-06-10 16:43:16 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:43:16 - 交易所: ['binance', 'bybit']
2025-06-10 16:43:16 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:43:16 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:43:16 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:43:16 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:43:16 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:43:16 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:43:16 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:43:16 - ==================================================
2025-06-10 16:44:55 - ==================================================
2025-06-10 16:44:55 - 開始計算資金費率差異
2025-06-10 16:44:55 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:44:55 - 交易所: ['binance', 'bybit']
2025-06-10 16:44:55 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:44:55 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:44:55 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:44:55 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:44:55 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:45:00 - ❌ 保存差異數據到數據庫時出錯: database is locked
2025-06-10 16:45:00 - ❌ 保存數據失敗
2025-06-10 16:45:00 - ==================================================
2025-06-10 16:47:19 - ==================================================
2025-06-10 16:47:19 - 開始計算資金費率差異
2025-06-10 16:47:19 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:47:19 - 交易所: ['binance', 'bybit']
2025-06-10 16:47:19 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:47:19 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:47:19 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:47:19 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:47:19 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:47:19 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:47:19 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:47:19 - ==================================================
2025-06-10 16:49:00 - ==================================================
2025-06-10 16:49:00 - 開始計算資金費率差異
2025-06-10 16:49:00 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:49:00 - 交易所: ['binance', 'bybit']
2025-06-10 16:49:00 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:49:00 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:49:00 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:49:00 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:49:00 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:49:00 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:49:00 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:49:00 - ==================================================
2025-06-10 16:49:11 - ==================================================
2025-06-10 16:49:11 - 開始計算資金費率差異
2025-06-10 16:49:11 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:49:11 - 交易所: ['binance', 'bybit']
2025-06-10 16:49:11 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:49:11 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:49:11 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:49:11 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:49:11 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:49:11 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:49:11 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:49:11 - ==================================================
2025-06-10 16:50:10 - ==================================================
2025-06-10 16:50:10 - 開始計算資金費率差異
2025-06-10 16:50:10 - 參數: symbol=None, start_date=None, end_date=None
2025-06-10 16:50:10 - 交易所: ['binance', 'bybit']
2025-06-10 16:50:10 - ✅ 從數據庫讀取到 288 條資金費率歷史記錄
2025-06-10 16:50:10 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-10 16:50:10 - 計算 binance vs bybit 的資金費率差異
2025-06-10 16:50:10 - ✅ 計算完成 binance vs bybit: 144 條差異記錄
2025-06-10 16:50:10 - ✅ 總共計算出 144 條資金費率差異記錄
2025-06-10 16:50:10 - ✅ 成功保存 144 條差異記錄到數據庫
2025-06-10 16:50:10 - ✅ 資金費率差異計算完成，共保存 144 條記錄
2025-06-10 16:50:10 - ==================================================
2025-06-11 03:02:39 - ==================================================
2025-06-11 03:02:39 - 開始計算資金費率差異
2025-06-11 03:02:39 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 03:02:39 - 交易所: ['binance', 'bybit']
2025-06-11 03:02:44 - ❌ 從數據庫讀取資金費率歷史數據時出錯: database is locked
2025-06-11 03:02:44 - ❌ 沒有可用的資金費率歷史數據，程序結束
2025-06-11 03:03:29 - ==================================================
2025-06-11 03:03:29 - 開始計算資金費率差異
2025-06-11 03:03:29 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 03:03:29 - 交易所: ['binance', 'bybit']
2025-06-11 03:03:36 - ✅ 從數據庫讀取到 5898144 條資金費率歷史記錄
2025-06-11 03:03:36 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 03:03:36 - 計算 binance vs bybit 的資金費率差異
2025-06-11 03:03:38 - ✅ 計算完成 binance vs bybit: 2754144 條差異記錄
2025-06-11 03:03:38 - ✅ 總共計算出 2754144 條資金費率差異記錄
2025-06-11 03:04:53 - ✅ 成功保存 2754144 條差異記錄到數據庫
2025-06-11 03:04:53 - ✅ 資金費率差異計算完成，共保存 2754144 條記錄
2025-06-11 03:04:53 - ==================================================
2025-06-11 03:32:22 - ==================================================
2025-06-11 03:32:22 - 開始計算資金費率差異
2025-06-11 03:32:22 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 03:32:22 - 交易所: ['binance', 'bybit']
2025-06-11 03:32:30 - ✅ 從數據庫讀取到 5898144 條資金費率歷史記錄
2025-06-11 03:32:30 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 03:32:30 - 計算 binance vs bybit 的資金費率差異
2025-06-11 03:32:31 - ✅ 計算完成 binance vs bybit: 2754144 條差異記錄
2025-06-11 03:32:32 - ✅ 總共計算出 2754144 條資金費率差異記錄
2025-06-11 03:33:48 - ✅ 成功保存 2754144 條差異記錄到數據庫
2025-06-11 03:33:48 - ✅ 資金費率差異計算完成，共保存 2754144 條記錄
2025-06-11 03:33:48 - ==================================================
2025-06-11 05:39:24 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:39:31 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:39:31 - ============================================================
2025-06-11 05:39:31 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:39:31 - ============================================================
2025-06-11 05:39:31 - 參數: symbol=None, start_date=2025-06-07, end_date=2025-06-07
2025-06-11 05:39:31 - 交易所: ['binance', 'bybit']
2025-06-11 05:39:31 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:39:31 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:39:31 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:39:31 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:39:31 - 日期範圍: 2025-06-07 到 2025-06-07
2025-06-11 05:39:31 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:39:31 - 🔄 執行SQL查詢中...
2025-06-11 05:39:31 - 📊 查詢參數數量: 4
2025-06-11 05:39:31 - ❌ SQL優化計算時出錯: Execution failed on sql '
                SELECT 
                    a.timestamp_utc,
                    a.symbol,
                    a.exchange as exchange_a,
                    b.exchange as exchange_b,
                    COALESCE(a.funding_rate, 0.0) as funding_rate_a,
                    COALESCE(b.funding_rate, 0.0) as funding_rate_b,
                    (COALESCE(a.funding_rate, 0.0) - COALESCE(b.funding_rate, 0.0)) as diff_ab
                FROM funding_rate_history a
                INNER JOIN funding_rate_history b 
                    ON a.timestamp_utc = b.timestamp_utc 
                    AND a.symbol = b.symbol
                WHERE DATE(a.timestamp_utc) >= ? AND DATE(a.timestamp_utc) <= ? AND a.exchange = ? AND b.exchange = ?
                 ORDER BY symbol, timestamp_utc, exchange_a, exchange_b': ambiguous column name: symbol
2025-06-11 05:39:31 - ❌ 沒有計算出差異數據，程序結束
2025-06-11 05:41:16 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:41:16 - ============================================================
2025-06-11 05:41:16 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:41:16 - ============================================================
2025-06-11 05:41:16 - 參數: symbol=None, start_date=2025-06-07, end_date=2025-06-07
2025-06-11 05:41:16 - 交易所: ['binance', 'bybit']
2025-06-11 05:41:16 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:41:16 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:41:16 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:41:16 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:41:16 - 日期範圍: 2025-06-07 到 2025-06-07
2025-06-11 05:41:16 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:41:16 - 🔄 執行SQL查詢中...
2025-06-11 05:41:16 - 📊 查詢參數數量: 4
2025-06-11 05:41:20 - ✅ SQL優化計算完成!
2025-06-11 05:41:20 -    📊 差異記錄: 5256 條
2025-06-11 05:41:20 -    📅 時間範圍: 2025-06-07 00:00:00 到 2025-06-07 23:00:00
2025-06-11 05:41:20 -    🔗 交易對數量: 219
2025-06-11 05:41:20 -    🏢 交易所對數量: 1
2025-06-11 05:41:20 - 💾 SQL優化保存: 5256 條差異記錄...
2025-06-11 05:41:20 - 📊 數據範例: Symbol=1INCHUSDT, binance vs bybit
2025-06-11 05:41:20 - ✅ SQL優化保存成功: 5256 條記錄
2025-06-11 05:41:20 - ❌ 程式執行出錯: Can only use .dt accessor with datetimelike values
2025-06-11 05:41:38 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:41:38 - ============================================================
2025-06-11 05:41:38 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:41:38 - ============================================================
2025-06-11 05:41:38 - 參數: symbol=None, start_date=2025-06-06, end_date=2025-06-06
2025-06-11 05:41:38 - 交易所: ['binance', 'bybit']
2025-06-11 05:41:38 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:41:38 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:41:38 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:41:38 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:41:38 - 日期範圍: 2025-06-06 到 2025-06-06
2025-06-11 05:41:38 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:41:38 - 🔄 執行SQL查詢中...
2025-06-11 05:41:38 - 📊 查詢參數數量: 4
2025-06-11 05:41:42 - ✅ SQL優化計算完成!
2025-06-11 05:41:42 -    📊 差異記錄: 5256 條
2025-06-11 05:41:42 -    📅 時間範圍: 2025-06-06 00:00:00 到 2025-06-06 23:00:00
2025-06-11 05:41:42 -    🔗 交易對數量: 219
2025-06-11 05:41:42 -    🏢 交易所對數量: 1
2025-06-11 05:41:42 - 💾 SQL優化保存: 5256 條差異記錄...
2025-06-11 05:41:42 - 📊 數據範例: Symbol=1INCHUSDT, binance vs bybit
2025-06-11 05:41:43 - ✅ SQL優化保存成功: 5256 條記錄
2025-06-11 05:41:43 - ✅ SQL優化版本完成！
2025-06-11 05:41:43 - 📊 處理統計: 5256 條記錄, 219 個交易對, 1 天
2025-06-11 05:41:43 - ============================================================
2025-06-11 05:42:55 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:42:55 - ============================================================
2025-06-11 05:42:55 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:42:55 - ============================================================
2025-06-11 05:42:55 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 05:42:55 - 交易所: ['binance', 'bybit']
2025-06-11 05:42:55 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:42:55 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:42:55 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:42:55 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:42:55 - 日期範圍: None 到 None
2025-06-11 05:42:55 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:42:55 - 🔄 執行SQL查詢中...
2025-06-11 05:42:55 - 📊 查詢參數數量: 2
2025-06-11 05:43:14 - ✅ SQL優化計算完成!
2025-06-11 05:43:14 -    📊 差異記錄: 2754144 條
2025-06-11 05:43:14 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 05:43:14 -    🔗 交易對數量: 219
2025-06-11 05:43:14 -    🏢 交易所對數量: 1
2025-06-11 05:43:15 - 💾 SQL優化保存: 2754144 條差異記錄...
2025-06-11 05:43:15 - 📊 數據範例: Symbol=1INCHUSDT, binance vs bybit
2025-06-11 05:44:25 - ❌ SQL優化保存時出錯: database is locked
2025-06-11 05:44:26 - ❌ 保存數據失敗
2025-06-11 05:44:26 - ============================================================
2025-06-11 05:45:11 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:45:11 - ============================================================
2025-06-11 05:45:11 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:45:11 - ============================================================
2025-06-11 05:45:11 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 05:45:11 - 交易所: ['binance', 'bybit']
2025-06-11 05:45:11 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:45:11 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:45:11 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:45:11 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:45:11 - 日期範圍: None 到 None
2025-06-11 05:45:11 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:45:11 - 🔄 執行SQL查詢中...
2025-06-11 05:45:11 - 📊 查詢參數數量: 2
2025-06-11 05:45:25 - ✅ SQL優化計算完成!
2025-06-11 05:45:25 -    📊 差異記錄: 2754144 條
2025-06-11 05:45:25 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 05:45:25 -    🔗 交易對數量: 219
2025-06-11 05:45:25 -    🏢 交易所對數量: 1
2025-06-11 05:45:26 - 💾 SQL優化保存: 2754144 條差異記錄...
2025-06-11 05:45:26 - 📊 數據範例: Symbol=1INCHUSDT, binance vs bybit
2025-06-11 05:47:07 - ✅ SQL優化保存成功: 2754144 條記錄
2025-06-11 05:47:08 - ✅ SQL優化版本完成！
2025-06-11 05:47:08 - 📊 處理統計: 2754144 條記錄, 219 個交易對, 524 天
2025-06-11 05:47:08 - ============================================================
2025-06-11 05:58:40 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:58:40 - ============================================================
2025-06-11 05:58:40 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:58:40 - ============================================================
2025-06-11 05:58:40 - 參數: symbol=None, start_date=2024-01-01, end_date=2024-01-01
2025-06-11 05:58:40 - 交易所: ['binance', 'bybit']
2025-06-11 05:58:40 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:58:40 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:58:40 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:58:40 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:58:40 - 日期範圍: 2024-01-01 到 2024-01-01
2025-06-11 05:58:40 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:58:40 - 🔄 執行SQL查詢中...
2025-06-11 05:58:40 - 📊 查詢參數數量: 4
2025-06-11 05:58:43 - ✅ SQL優化計算完成!
2025-06-11 05:58:43 -    📊 差異記錄: 5256 條
2025-06-11 05:58:43 -    📅 時間範圍: 2024-01-01 00:00:00 到 2024-01-01 23:00:00
2025-06-11 05:58:43 -    🔗 交易對數量: 219
2025-06-11 05:58:43 -    🏢 交易所對數量: 1
2025-06-11 05:58:43 - 💾 開始保存 5256 條差異記錄到數據庫...
2025-06-11 05:58:43 - 🚀 使用向量化插入方法
2025-06-11 05:58:43 - ✅ 向量化插入完成: 5256 條記錄
2025-06-11 05:58:43 - ⏱️ 插入耗時: 0.09 秒
2025-06-11 05:58:43 - 📊 插入速度: 57667 條/秒
2025-06-11 05:58:43 - ✅ SQL優化版本完成！
2025-06-11 05:58:43 - 📊 處理統計: 5256 條記錄, 219 個交易對, 1 天
2025-06-11 05:58:43 - ============================================================
2025-06-11 05:58:51 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:58:51 - ============================================================
2025-06-11 05:58:51 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:58:51 - ============================================================
2025-06-11 05:58:51 - 參數: symbol=None, start_date=2024-01-02, end_date=2024-01-02
2025-06-11 05:58:51 - 交易所: ['binance', 'bybit']
2025-06-11 05:58:51 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:58:51 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:58:51 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:58:51 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:58:51 - 日期範圍: 2024-01-02 到 2024-01-02
2025-06-11 05:58:51 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:58:51 - 🔄 執行SQL查詢中...
2025-06-11 05:58:51 - 📊 查詢參數數量: 4
2025-06-11 05:58:52 - ✅ SQL優化計算完成!
2025-06-11 05:58:52 -    📊 差異記錄: 5256 條
2025-06-11 05:58:52 -    📅 時間範圍: 2024-01-02 00:00:00 到 2024-01-02 23:00:00
2025-06-11 05:58:52 -    🔗 交易對數量: 219
2025-06-11 05:58:52 -    🏢 交易所對數量: 1
2025-06-11 05:58:52 - 🔬 性能測試: 使用舊版插入方法
2025-06-11 05:58:52 - 💾 開始保存 5256 條差異記錄到數據庫...
2025-06-11 05:58:52 - ⚠️ 使用舊版插入方法進行性能測試
2025-06-11 05:58:53 - ✅ 舊版逐行插入完成: 5256 條記錄
2025-06-11 05:58:53 - ⏱️ 插入耗時: 0.20 秒
2025-06-11 05:58:53 - 📊 插入速度: 25860 條/秒
2025-06-11 05:58:53 - ✅ SQL優化版本完成！
2025-06-11 05:58:53 - 📊 處理統計: 5256 條記錄, 219 個交易對, 1 天
2025-06-11 05:58:53 - ============================================================
2025-06-11 05:59:01 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 05:59:01 - ============================================================
2025-06-11 05:59:01 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 05:59:01 - ============================================================
2025-06-11 05:59:01 - 參數: symbol=None, start_date=2024-01-15, end_date=2024-01-20
2025-06-11 05:59:01 - 交易所: ['binance', 'bybit']
2025-06-11 05:59:01 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 05:59:01 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 05:59:01 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 05:59:01 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 05:59:01 - 日期範圍: 2024-01-15 到 2024-01-20
2025-06-11 05:59:01 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 05:59:01 - 🔄 執行SQL查詢中...
2025-06-11 05:59:01 - 📊 查詢參數數量: 4
2025-06-11 05:59:03 - ✅ SQL優化計算完成!
2025-06-11 05:59:03 -    📊 差異記錄: 31536 條
2025-06-11 05:59:03 -    📅 時間範圍: 2024-01-15 00:00:00 到 2024-01-20 23:00:00
2025-06-11 05:59:03 -    🔗 交易對數量: 219
2025-06-11 05:59:03 -    🏢 交易所對數量: 1
2025-06-11 05:59:03 - 💾 開始保存 31536 條差異記錄到數據庫...
2025-06-11 05:59:03 - 🚀 使用向量化插入方法
2025-06-11 05:59:03 - ✅ 向量化插入完成: 31536 條記錄
2025-06-11 05:59:03 - ⏱️ 插入耗時: 0.44 秒
2025-06-11 05:59:03 - 📊 插入速度: 70926 條/秒
2025-06-11 05:59:03 - ✅ SQL優化版本完成！
2025-06-11 05:59:03 - 📊 處理統計: 31536 條記錄, 219 個交易對, 6 天
2025-06-11 05:59:03 - ============================================================
2025-06-11 06:02:10 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:02:10 - ============================================================
2025-06-11 06:02:10 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:02:10 - ============================================================
2025-06-11 06:02:10 - 參數: symbol=None, start_date=2024-01-21, end_date=2024-01-26
2025-06-11 06:02:10 - 交易所: ['binance', 'bybit']
2025-06-11 06:02:10 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:02:10 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:02:10 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:02:10 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:02:10 - 日期範圍: 2024-01-21 到 2024-01-26
2025-06-11 06:02:10 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:02:10 - 🔄 執行SQL查詢中...
2025-06-11 06:02:10 - 📊 查詢參數數量: 4
2025-06-11 06:02:12 - ✅ SQL優化計算完成!
2025-06-11 06:02:12 -    📊 差異記錄: 31536 條
2025-06-11 06:02:12 -    📅 時間範圍: 2024-01-21 00:00:00 到 2024-01-26 23:00:00
2025-06-11 06:02:12 -    🔗 交易對數量: 219
2025-06-11 06:02:12 -    🏢 交易所對數量: 1
2025-06-11 06:02:12 - 🔬 性能測試: 使用舊版插入方法
2025-06-11 06:02:12 - 💾 開始保存 31536 條差異記錄到數據庫...
2025-06-11 06:02:12 - ⚠️ 使用舊版插入方法進行性能測試
2025-06-11 06:02:13 - ✅ 舊版逐行插入完成: 31536 條記錄
2025-06-11 06:02:13 - ⏱️ 插入耗時: 1.21 秒
2025-06-11 06:02:13 - 📊 插入速度: 26131 條/秒
2025-06-11 06:02:13 - ✅ SQL優化版本完成！
2025-06-11 06:02:13 - 📊 處理統計: 31536 條記錄, 219 個交易對, 6 天
2025-06-11 06:02:13 - ============================================================
2025-06-11 06:08:21 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:08:21 - ============================================================
2025-06-11 06:08:21 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:08:21 - ============================================================
2025-06-11 06:08:21 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 06:08:21 - 交易所: ['binance', 'bybit']
2025-06-11 06:08:21 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:08:21 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:08:21 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:08:21 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:08:21 - 日期範圍: None 到 None
2025-06-11 06:08:21 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:08:21 - 🔄 執行SQL查詢中...
2025-06-11 06:08:21 - 📊 查詢參數數量: 2
2025-06-11 06:08:35 - ✅ SQL優化計算完成!
2025-06-11 06:08:35 -    📊 差異記錄: 2754144 條
2025-06-11 06:08:35 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 06:08:36 -    🔗 交易對數量: 219
2025-06-11 06:08:36 -    🏢 交易所對數量: 1
2025-06-11 06:08:36 - 💾 開始保存 2754144 條差異記錄到數據庫...
2025-06-11 06:08:36 - 🚀 使用向量化插入方法
2025-06-11 06:09:13 - ✅ 向量化插入完成: 2754144 條記錄
2025-06-11 06:09:13 - ⏱️ 插入耗時: 36.58 秒
2025-06-11 06:09:13 - 📊 插入速度: 75299 條/秒
2025-06-11 06:09:14 - ✅ SQL優化版本完成！
2025-06-11 06:09:14 - 📊 處理統計: 2754144 條記錄, 219 個交易對, 524 天
2025-06-11 06:09:14 - ============================================================
2025-06-11 06:20:03 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:20:03 - ============================================================
2025-06-11 06:20:03 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:20:03 - ============================================================
2025-06-11 06:20:03 - 參數: symbol=None, start_date=2024-02-01, end_date=2024-02-06
2025-06-11 06:20:03 - 交易所: ['binance', 'bybit']
2025-06-11 06:20:03 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:20:03 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:20:03 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:20:03 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:20:03 - 日期範圍: 2024-02-01 到 2024-02-06
2025-06-11 06:20:03 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:20:03 - 🔄 執行SQL查詢中...
2025-06-11 06:20:03 - 📊 查詢參數數量: 4
2025-06-11 06:20:06 - ✅ SQL優化計算完成!
2025-06-11 06:20:06 -    📊 差異記錄: 31536 條
2025-06-11 06:20:06 -    📅 時間範圍: 2024-02-01 00:00:00 到 2024-02-06 23:00:00
2025-06-11 06:20:06 -    🔗 交易對數量: 219
2025-06-11 06:20:06 -    🏢 交易所對數量: 1
2025-06-11 06:20:06 - 💾 開始保存 31536 條差異記錄到數據庫...
2025-06-11 06:20:06 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 06:20:06 - ✅ 解法2：批量處理+SQLite優化完成: 31,536 條記錄
2025-06-11 06:20:06 - ⏱️ 插入耗時: 0.42 秒
2025-06-11 06:20:06 - 📊 插入速度: 75,895 條/秒
2025-06-11 06:20:06 - ✅ SQL優化版本完成！
2025-06-11 06:20:06 - 📊 處理統計: 31536 條記錄, 219 個交易對, 6 天
2025-06-11 06:20:06 - ============================================================
2025-06-11 06:20:29 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:20:29 - ============================================================
2025-06-11 06:20:29 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:20:29 - ============================================================
2025-06-11 06:20:29 - 參數: symbol=None, start_date=2024-02-07, end_date=2024-02-12
2025-06-11 06:20:29 - 交易所: ['binance', 'bybit']
2025-06-11 06:20:29 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:20:29 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:20:29 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:20:29 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:20:29 - 日期範圍: 2024-02-07 到 2024-02-12
2025-06-11 06:20:29 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:20:29 - 🔄 執行SQL查詢中...
2025-06-11 06:20:29 - 📊 查詢參數數量: 4
2025-06-11 06:20:31 - ✅ SQL優化計算完成!
2025-06-11 06:20:31 -    📊 差異記錄: 31536 條
2025-06-11 06:20:31 -    📅 時間範圍: 2024-02-07 00:00:00 到 2024-02-12 23:00:00
2025-06-11 06:20:31 -    🔗 交易對數量: 219
2025-06-11 06:20:31 -    🏢 交易所對數量: 1
2025-06-11 06:20:31 - 💾 開始保存 31536 條差異記錄到數據庫...
2025-06-11 06:20:31 - 🔧 使用方法: 解法1：向量化處理
2025-06-11 06:20:32 - ✅ 解法1：向量化處理完成: 31,536 條記錄
2025-06-11 06:20:32 - ⏱️ 插入耗時: 0.44 秒
2025-06-11 06:20:32 - 📊 插入速度: 72,475 條/秒
2025-06-11 06:20:32 - ✅ SQL優化版本完成！
2025-06-11 06:20:32 - 📊 處理統計: 31536 條記錄, 219 個交易對, 6 天
2025-06-11 06:20:32 - ============================================================
2025-06-11 06:21:00 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:21:00 - ============================================================
2025-06-11 06:21:00 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:21:00 - ============================================================
2025-06-11 06:21:00 - 參數: symbol=None, start_date=2024-03-01, end_date=2024-03-31
2025-06-11 06:21:00 - 交易所: ['binance', 'bybit']
2025-06-11 06:21:00 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:21:00 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:21:00 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:21:00 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:21:00 - 日期範圍: 2024-03-01 到 2024-03-31
2025-06-11 06:21:00 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:21:00 - 🔄 執行SQL查詢中...
2025-06-11 06:21:00 - 📊 查詢參數數量: 4
2025-06-11 06:21:03 - ✅ SQL優化計算完成!
2025-06-11 06:21:03 -    📊 差異記錄: 162936 條
2025-06-11 06:21:03 -    📅 時間範圍: 2024-03-01 00:00:00 到 2024-03-31 23:00:00
2025-06-11 06:21:03 -    🔗 交易對數量: 219
2025-06-11 06:21:03 -    🏢 交易所對數量: 1
2025-06-11 06:21:03 - 💾 開始保存 162936 條差異記錄到數據庫...
2025-06-11 06:21:03 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 06:21:05 - ✅ 解法2：批量處理+SQLite優化完成: 162,936 條記錄
2025-06-11 06:21:05 - ⏱️ 插入耗時: 1.51 秒
2025-06-11 06:21:05 - 📊 插入速度: 108,053 條/秒
2025-06-11 06:21:05 - ✅ SQL優化版本完成！
2025-06-11 06:21:05 - 📊 處理統計: 162936 條記錄, 219 個交易對, 31 天
2025-06-11 06:21:05 - ============================================================
2025-06-11 06:21:14 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:21:14 - ============================================================
2025-06-11 06:21:14 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:21:14 - ============================================================
2025-06-11 06:21:14 - 參數: symbol=None, start_date=2024-04-01, end_date=2024-04-30
2025-06-11 06:21:14 - 交易所: ['binance', 'bybit']
2025-06-11 06:21:14 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:21:14 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:21:14 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:21:14 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:21:14 - 日期範圍: 2024-04-01 到 2024-04-30
2025-06-11 06:21:14 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:21:14 - 🔄 執行SQL查詢中...
2025-06-11 06:21:14 - 📊 查詢參數數量: 4
2025-06-11 06:21:16 - ✅ SQL優化計算完成!
2025-06-11 06:21:16 -    📊 差異記錄: 157680 條
2025-06-11 06:21:16 -    📅 時間範圍: 2024-04-01 00:00:00 到 2024-04-30 23:00:00
2025-06-11 06:21:16 -    🔗 交易對數量: 219
2025-06-11 06:21:16 -    🏢 交易所對數量: 1
2025-06-11 06:21:16 - 💾 開始保存 157680 條差異記錄到數據庫...
2025-06-11 06:21:16 - 🔧 使用方法: 解法1：向量化處理
2025-06-11 06:21:19 - ✅ 解法1：向量化處理完成: 157,680 條記錄
2025-06-11 06:21:19 - ⏱️ 插入耗時: 2.25 秒
2025-06-11 06:21:19 - 📊 插入速度: 70,128 條/秒
2025-06-11 06:21:19 - ✅ SQL優化版本完成！
2025-06-11 06:21:19 - 📊 處理統計: 157680 條記錄, 219 個交易對, 30 天
2025-06-11 06:21:19 - ============================================================
2025-06-11 06:22:59 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 06:22:59 - ============================================================
2025-06-11 06:22:59 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 06:22:59 - ============================================================
2025-06-11 06:22:59 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 06:22:59 - 交易所: ['binance', 'bybit']
2025-06-11 06:22:59 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 06:22:59 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 06:22:59 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 06:22:59 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 06:22:59 - 日期範圍: None 到 None
2025-06-11 06:22:59 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 06:22:59 - 🔄 執行SQL查詢中...
2025-06-11 06:22:59 - 📊 查詢參數數量: 2
2025-06-11 06:23:13 - ✅ SQL優化計算完成!
2025-06-11 06:23:13 -    📊 差異記錄: 2754144 條
2025-06-11 06:23:14 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 06:23:14 -    🔗 交易對數量: 219
2025-06-11 06:23:14 -    🏢 交易所對數量: 1
2025-06-11 06:23:14 - 💾 開始保存 2754144 條差異記錄到數據庫...
2025-06-11 06:23:14 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 06:23:48 - ✅ 解法2：批量處理+SQLite優化完成: 2,754,144 條記錄
2025-06-11 06:23:48 - ⏱️ 插入耗時: 33.35 秒
2025-06-11 06:23:48 - 📊 插入速度: 82,583 條/秒
2025-06-11 06:23:48 - ✅ SQL優化版本完成！
2025-06-11 06:23:48 - 📊 處理統計: 2754144 條記錄, 219 個交易對, 524 天
2025-06-11 06:23:48 - ============================================================
2025-06-11 07:10:55 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 07:10:55 - ============================================================
2025-06-11 07:10:55 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 07:10:55 - ============================================================
2025-06-11 07:10:55 - 參數: symbol=None, start_date=2024-04-23, end_date=2024-04-23
2025-06-11 07:10:55 - 交易所: ['binance', 'bybit']
2025-06-11 07:10:55 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 07:10:55 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 07:10:55 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 07:10:55 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 07:10:55 - 日期範圍: 2024-04-23 到 2024-04-23
2025-06-11 07:10:55 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 07:10:55 - 🔄 執行SQL查詢中...
2025-06-11 07:10:55 - 📊 查詢參數數量: 4
2025-06-11 07:10:58 - ✅ SQL優化計算完成!
2025-06-11 07:10:58 -    📊 差異記錄: 5256 條
2025-06-11 07:10:58 -    📅 時間範圍: 2024-04-23 00:00:00 到 2024-04-23 23:00:00
2025-06-11 07:10:58 -    🔗 交易對數量: 219
2025-06-11 07:10:58 -    🏢 交易所對數量: 1
2025-06-11 07:10:58 - 💾 開始保存 5256 條差異記錄到數據庫...
2025-06-11 07:10:58 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 07:10:59 - ✅ 解法2：批量處理+SQLite優化完成: 5,256 條記錄
2025-06-11 07:10:59 - ⏱️ 插入耗時: 0.04 秒
2025-06-11 07:10:59 - 📊 插入速度: 146,151 條/秒
2025-06-11 07:10:59 - ✅ SQL優化版本完成！
2025-06-11 07:10:59 - 📊 處理統計: 5256 條記錄, 219 個交易對, 1 天
2025-06-11 07:10:59 - ============================================================
2025-06-11 07:13:15 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 07:13:15 - ============================================================
2025-06-11 07:13:15 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 07:13:15 - ============================================================
2025-06-11 07:13:15 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 07:13:15 - 交易所: ['binance', 'bybit']
2025-06-11 07:13:15 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 07:13:15 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 07:13:15 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 07:13:15 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 07:13:15 - 日期範圍: None 到 None
2025-06-11 07:13:15 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 07:13:15 - 🔄 執行SQL查詢中...
2025-06-11 07:13:15 - 📊 查詢參數數量: 2
2025-06-11 07:13:32 - ✅ SQL優化計算完成!
2025-06-11 07:13:32 -    📊 差異記錄: 2754144 條
2025-06-11 07:13:32 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 07:13:32 -    🔗 交易對數量: 219
2025-06-11 07:13:32 -    🏢 交易所對數量: 1
2025-06-11 07:13:32 - 💾 開始保存 2754144 條差異記錄到數據庫...
2025-06-11 07:13:32 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 07:14:09 - ✅ 解法2：批量處理+SQLite優化完成: 2,754,144 條記錄
2025-06-11 07:14:09 - ⏱️ 插入耗時: 36.66 秒
2025-06-11 07:14:09 - 📊 插入速度: 75,122 條/秒
2025-06-11 07:14:10 - ✅ SQL優化版本完成！
2025-06-11 07:14:10 - 📊 處理統計: 2754144 條記錄, 219 個交易對, 524 天
2025-06-11 07:14:10 - ============================================================
2025-06-11 07:20:07 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 07:20:07 - ============================================================
2025-06-11 07:20:07 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 07:20:07 - ============================================================
2025-06-11 07:20:07 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 07:20:07 - 交易所: ['binance', 'bybit']
2025-06-11 07:20:07 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 07:20:07 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 07:20:07 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 07:20:07 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 07:20:07 - 日期範圍: None 到 None
2025-06-11 07:20:07 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 07:20:07 - 🔄 執行SQL查詢中...
2025-06-11 07:20:07 - 📊 查詢參數數量: 2
2025-06-11 07:20:19 - ✅ SQL優化計算完成!
2025-06-11 07:20:19 -    📊 差異記錄: 2754144 條
2025-06-11 07:20:19 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-07 23:00:00
2025-06-11 07:20:19 -    🔗 交易對數量: 219
2025-06-11 07:20:20 -    🏢 交易所對數量: 1
2025-06-11 07:20:20 - 💾 開始保存 2754144 條差異記錄到數據庫...
2025-06-11 07:20:20 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 07:20:51 - ✅ 解法2：批量處理+SQLite優化完成: 2,754,144 條記錄
2025-06-11 07:20:51 - ⏱️ 插入耗時: 31.42 秒
2025-06-11 07:20:51 - 📊 插入速度: 87,664 條/秒
2025-06-11 07:20:52 - ✅ SQL優化版本完成！
2025-06-11 07:20:52 - 📊 處理統計: 2754144 條記錄, 219 個交易對, 524 天
2025-06-11 07:20:52 - ============================================================
2025-06-11 14:34:33 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-11 14:34:33 - ============================================================
2025-06-11 14:34:33 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-11 14:34:33 - ============================================================
2025-06-11 14:34:33 - 參數: symbol=None, start_date=None, end_date=None
2025-06-11 14:34:33 - 交易所: ['binance', 'bybit']
2025-06-11 14:34:33 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-11 14:34:33 - 🚀 使用SQL優化版本 (推薦)
2025-06-11 14:34:33 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-11 14:34:33 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-11 14:34:33 - 日期範圍: None 到 None
2025-06-11 14:34:33 - 指定交易所對: [('binance', 'bybit')]
2025-06-11 14:34:33 - 🔄 執行SQL查詢中...
2025-06-11 14:34:33 - 📊 查詢參數數量: 2
2025-06-11 14:34:52 - ✅ SQL優化計算完成!
2025-06-11 14:34:52 -    📊 差異記錄: 2757024 條
2025-06-11 14:34:53 -    📅 時間範圍: 2024-01-01 00:00:00 到 2025-06-10 23:00:00
2025-06-11 14:34:53 -    🔗 交易對數量: 219
2025-06-11 14:34:53 -    🏢 交易所對數量: 1
2025-06-11 14:34:53 - 💾 開始保存 2757024 條差異記錄到數據庫...
2025-06-11 14:34:53 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-11 14:36:03 - ✅ 解法2：批量處理+SQLite優化完成: 2,757,024 條記錄
2025-06-11 14:36:03 - ⏱️ 插入耗時: 69.97 秒
2025-06-11 14:36:03 - 📊 插入速度: 39,405 條/秒
2025-06-11 14:36:04 - ✅ SQL優化版本完成！
2025-06-11 14:36:04 - 📊 處理統計: 2757024 條記錄, 219 個交易對, 527 天
2025-06-11 14:36:04 - ============================================================
2025-06-12 10:32:11 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-12 10:32:11 - ============================================================
2025-06-12 10:32:11 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-12 10:32:11 - ============================================================
2025-06-12 10:32:11 - 參數: symbol=None, start_date=None, end_date=None
2025-06-12 10:32:11 - 交易所: ['binance', 'bybit']
2025-06-12 10:32:11 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-12 10:32:11 - 🚀 使用SQL優化版本 (推薦)
2025-06-12 10:32:11 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-12 10:32:11 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-12 10:32:11 - 日期範圍: None 到 None
2025-06-12 10:32:11 - 指定交易所對: [('binance', 'bybit')]
2025-06-12 10:32:11 - 🔄 執行SQL查詢中...
2025-06-12 10:32:11 - 📊 查詢參數數量: 2
2025-06-12 10:32:11 - ⚠️ SQL查詢沒有返回任何結果
2025-06-12 10:32:11 - ❌ 沒有計算出差異數據，程序結束
2025-06-12 14:48:32 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-12 14:48:32 - ============================================================
2025-06-12 14:48:32 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-12 14:48:32 - ============================================================
2025-06-12 14:48:32 - 參數: symbol=None, start_date=None, end_date=None
2025-06-12 14:48:32 - 交易所: ['binance', 'bybit']
2025-06-12 14:48:32 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-12 14:48:32 - 🚀 使用SQL優化版本 (推薦)
2025-06-12 14:48:32 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-12 14:48:32 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-12 14:48:32 - 日期範圍: None 到 None
2025-06-12 14:48:32 - 指定交易所對: [('binance', 'bybit')]
2025-06-12 14:48:32 - 🔄 執行SQL查詢中...
2025-06-12 14:48:32 - 📊 查詢參數數量: 2
2025-06-12 14:48:34 - ✅ SQL優化計算完成!
2025-06-12 14:48:34 -    📊 差異記錄: 265608 條
2025-06-12 14:48:34 -    📅 時間範圍: 2025-01-01T00:00:00+00:00 到 2025-06-01T23:00:00+00:00
2025-06-12 14:48:34 -    🔗 交易對數量: 76
2025-06-12 14:48:34 -    🏢 交易所對數量: 1
2025-06-12 14:48:34 - 💾 開始保存 265608 條差異記錄到數據庫...
2025-06-12 14:48:34 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-12 14:48:40 - ✅ 解法2：批量處理+SQLite優化完成: 265,608 條記錄
2025-06-12 14:48:40 - ⏱️ 插入耗時: 5.19 秒
2025-06-12 14:48:40 - 📊 插入速度: 51,192 條/秒
2025-06-12 14:48:40 - ✅ SQL優化版本完成！
2025-06-12 14:48:40 - 📊 處理統計: 265608 條記錄, 76 個交易對, 152 天
2025-06-12 14:48:40 - ============================================================
2025-06-12 14:50:45 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-12 14:50:45 - ============================================================
2025-06-12 14:50:45 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-12 14:50:45 - ============================================================
2025-06-12 14:50:45 - 參數: symbol=None, start_date=None, end_date=None
2025-06-12 14:50:45 - 交易所: ['binance', 'bybit']
2025-06-12 14:50:45 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-12 14:50:45 - 🚀 使用SQL優化版本 (推薦)
2025-06-12 14:50:45 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-12 14:50:45 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-12 14:50:45 - 日期範圍: None 到 None
2025-06-12 14:50:45 - 指定交易所對: [('binance', 'bybit')]
2025-06-12 14:50:45 - 🔄 執行SQL查詢中...
2025-06-12 14:50:45 - 📊 查詢參數數量: 2
2025-06-12 14:50:47 - ✅ SQL優化計算完成!
2025-06-12 14:50:47 -    📊 差異記錄: 265608 條
2025-06-12 14:50:47 -    📅 時間範圍: 2025-01-01T00:00:00+00:00 到 2025-06-01T23:00:00+00:00
2025-06-12 14:50:47 -    🔗 交易對數量: 76
2025-06-12 14:50:47 -    🏢 交易所對數量: 1
2025-06-12 14:50:47 - 💾 開始保存 265608 條差異記錄到數據庫...
2025-06-12 14:50:47 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-12 14:50:49 - ✅ 解法2：批量處理+SQLite優化完成: 265,608 條記錄
2025-06-12 14:50:49 - ⏱️ 插入耗時: 2.03 秒
2025-06-12 14:50:49 - 📊 插入速度: 130,678 條/秒
2025-06-12 14:50:49 - ✅ SQL優化版本完成！
2025-06-12 14:50:49 - 📊 處理統計: 265608 條記錄, 76 個交易對, 152 天
2025-06-12 14:50:49 - ============================================================
2025-06-14 14:25:36 - 🚀 資金費率差異計算程式啟動 (SQL優化版本 v2)
2025-06-14 14:25:36 - ============================================================
2025-06-14 14:25:36 - 📅 資金費率差異計算 v2 (SQL優化版本)
2025-06-14 14:25:36 - ============================================================
2025-06-14 14:25:36 - 參數: symbol=None, start_date=None, end_date=None
2025-06-14 14:25:36 - 交易所: ['binance', 'bybit']
2025-06-14 14:25:36 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-14 14:25:36 - 🚀 使用SQL優化版本 (推薦)
2025-06-14 14:25:36 - 🚀 SQL優化版本：計算資金費率差異...
2025-06-14 14:25:36 - 參數: symbol=None, exchanges=['binance', 'bybit']
2025-06-14 14:25:36 - 日期範圍: None 到 None
2025-06-14 14:25:36 - 指定交易所對: [('binance', 'bybit')]
2025-06-14 14:25:36 - 🔄 執行SQL查詢中...
2025-06-14 14:25:36 - 📊 查詢參數數量: 2
2025-06-14 14:25:36 - ✅ SQL優化計算完成!
2025-06-14 14:25:36 -    📊 差異記錄: 3840 條
2025-06-14 14:25:36 -    📅 時間範圍: 2025-01-01T00:00:00+00:00 到 2025-01-20T23:00:00+00:00
2025-06-14 14:25:36 -    🔗 交易對數量: 8
2025-06-14 14:25:36 -    🏢 交易所對數量: 1
2025-06-14 14:25:36 - 💾 開始保存 3840 條差異記錄到數據庫...
2025-06-14 14:25:36 - 🔧 使用方法: 解法2：批量處理+SQLite優化
2025-06-14 14:25:36 - ✅ 解法2：批量處理+SQLite優化完成: 3,840 條記錄
2025-06-14 14:25:36 - ⏱️ 插入耗時: 0.07 秒
2025-06-14 14:25:36 - 📊 插入速度: 57,129 條/秒
2025-06-14 14:25:36 - ✅ SQL優化版本完成！
2025-06-14 14:25:36 - 📊 處理統計: 3840 條記錄, 8 個交易對, 20 天
2025-06-14 14:25:36 - ============================================================
2025-06-21 03:08:20 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:08:28 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:08:28 - ============================================================
2025-06-21 03:08:28 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:08:28 - ============================================================
2025-06-21 03:08:28 - 參數: symbol=None
2025-06-21 03:08:28 - 日期: None ~ None
2025-06-21 03:08:28 - 交易所: ['binance', 'bybit']
2025-06-21 03:08:28 - 強制全量: False
2025-06-21 03:08:28 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:08:28 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 03:08:28 - 📊 來源數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00 (10 條)
2025-06-21 03:08:28 - 📊 結果數據範圍: None ~ None (0 條)
2025-06-21 03:08:28 - 📝 結果數據為空，將處理全部來源數據
2025-06-21 03:08:28 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:08:28 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:08:28 - ✅ 獲取到 9 條歷史數據
2025-06-21 03:08:28 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:08:28 -    🔗 交易對: 2
2025-06-21 03:08:28 -    🏢 交易所: 2
2025-06-21 03:08:28 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:08:28 - 📊 輸入數據: 9 條記錄
2025-06-21 03:08:28 - 🔗 交易對數量: 2
2025-06-21 03:08:28 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:08:28 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:08:28 - ✅ BTC/USDT: 計算完成 25 條差異記錄
2025-06-21 03:08:28 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:08:28 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:08:28 - ✅ V3計算完成!
2025-06-21 03:08:28 -    📊 總記錄: 26
2025-06-21 03:08:28 -    ✅ 有效差異: 3
2025-06-21 03:08:28 -    ⚪ NULL差異: 23
2025-06-21 03:08:28 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:08:28 - 💾 開始保存 26 條差異數據...
2025-06-21 03:08:28 - ✅ 成功保存 26 條差異數據
2025-06-21 03:08:28 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 26 條
2025-06-21 03:08:28 - ============================================================
2025-06-21 03:08:28 - 🎉 V3版本處理完成！總共處理 26 條記錄
2025-06-21 03:08:28 - ============================================================
2025-06-21 03:11:10 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:11:10 - ============================================================
2025-06-21 03:11:10 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:11:10 - ============================================================
2025-06-21 03:11:10 - 參數: symbol=None
2025-06-21 03:11:10 - 日期: None ~ None
2025-06-21 03:11:10 - 交易所: ['binance', 'bybit']
2025-06-21 03:11:10 - 強制全量: False
2025-06-21 03:11:10 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:11:10 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 03:11:10 - 📊 來源數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00 (10 條)
2025-06-21 03:11:10 - 📊 結果數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00 (26 條)
2025-06-21 03:11:10 - ✅ 數據已是最新，無需處理
2025-06-21 03:11:10 - ✅ 沒有需要處理的數據範圍
2025-06-21 03:11:18 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:11:18 - ============================================================
2025-06-21 03:11:18 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:11:18 - ============================================================
2025-06-21 03:11:18 - 參數: symbol=None
2025-06-21 03:11:18 - 日期: None ~ None
2025-06-21 03:11:18 - 交易所: ['binance', 'bybit']
2025-06-21 03:11:18 - 強制全量: True
2025-06-21 03:11:18 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:11:18 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:11:18 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:11:18 - ✅ 獲取到 9 條歷史數據
2025-06-21 03:11:18 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:11:18 -    🔗 交易對: 2
2025-06-21 03:11:18 -    🏢 交易所: 2
2025-06-21 03:11:18 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:11:18 - 📊 輸入數據: 9 條記錄
2025-06-21 03:11:18 - 🔗 交易對數量: 2
2025-06-21 03:11:18 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:11:18 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:11:18 - ✅ BTC/USDT: 計算完成 25 條差異記錄
2025-06-21 03:11:18 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:11:18 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:11:18 - ✅ V3計算完成!
2025-06-21 03:11:18 -    📊 總記錄: 26
2025-06-21 03:11:18 -    ✅ 有效差異: 3
2025-06-21 03:11:18 -    ⚪ NULL差異: 23
2025-06-21 03:11:18 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:11:18 - 💾 開始保存 26 條差異數據...
2025-06-21 03:11:18 - 📊 NULL值統計: {'funding_rate_a': np.int64(21), 'funding_rate_b': np.int64(23), 'diff_ab': np.int64(23)}
2025-06-21 03:11:18 - ✅ 自定義插入完成: 3 條記錄
2025-06-21 03:11:18 - ✅ 成功保存 3 條差異數據
2025-06-21 03:11:18 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 3 條
2025-06-21 03:11:18 - ============================================================
2025-06-21 03:11:18 - 🎉 V3版本處理完成！總共處理 3 條記錄
2025-06-21 03:11:18 - ============================================================
2025-06-21 03:13:42 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:13:42 - ============================================================
2025-06-21 03:13:42 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:13:42 - ============================================================
2025-06-21 03:13:42 - 參數: symbol=None
2025-06-21 03:13:42 - 日期: None ~ None
2025-06-21 03:13:42 - 交易所: ['binance', 'bybit']
2025-06-21 03:13:42 - 強制全量: True
2025-06-21 03:13:42 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:13:42 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:13:42 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:13:42 - ✅ 獲取到 9 條歷史數據
2025-06-21 03:13:42 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:13:42 -    🔗 交易對: 2
2025-06-21 03:13:42 -    🏢 交易所: 2
2025-06-21 03:13:42 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:13:42 - 📊 輸入數據: 9 條記錄
2025-06-21 03:13:42 - 🔗 交易對數量: 2
2025-06-21 03:13:42 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:13:42 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:13:42 - ✅ BTC/USDT: 計算完成 25 條差異記錄
2025-06-21 03:13:42 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:13:42 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:13:42 - ✅ V3計算完成!
2025-06-21 03:13:42 -    📊 總記錄: 26
2025-06-21 03:13:42 -    ✅ 有效差異: 3
2025-06-21 03:13:42 -    ⚪ NULL差異: 23
2025-06-21 03:13:42 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:13:42 - 💾 開始保存 26 條差異數據...
2025-06-21 03:13:42 - 📊 NULL值統計: {'funding_rate_a': np.int64(21), 'funding_rate_b': np.int64(23), 'diff_ab': np.int64(23)}
2025-06-21 03:13:42 - ✅ 自定義插入完成: 26 條記錄
2025-06-21 03:13:42 - ✅ 成功保存 26 條差異數據
2025-06-21 03:13:42 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 26 條
2025-06-21 03:13:42 - ============================================================
2025-06-21 03:13:42 - 🎉 V3版本處理完成！總共處理 26 條記錄
2025-06-21 03:13:42 - ============================================================
2025-06-21 03:14:47 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:14:47 - ============================================================
2025-06-21 03:14:47 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:14:47 - ============================================================
2025-06-21 03:14:47 - 參數: symbol=None
2025-06-21 03:14:47 - 日期: None ~ None
2025-06-21 03:14:47 - 交易所: ['binance', 'bybit']
2025-06-21 03:14:47 - 強制全量: True
2025-06-21 03:14:47 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:14:47 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:14:47 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:14:47 - ✅ 獲取到 9 條歷史數據
2025-06-21 03:14:47 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:14:47 -    🔗 交易對: 2
2025-06-21 03:14:47 -    🏢 交易所: 2
2025-06-21 03:14:47 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:14:47 - 📊 輸入數據: 9 條記錄
2025-06-21 03:14:47 - 🔗 交易對數量: 2
2025-06-21 03:14:47 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:14:47 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:14:47 - ✅ BTC/USDT: 計算完成 25 條差異記錄
2025-06-21 03:14:47 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:14:47 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:14:47 - ✅ V3計算完成!
2025-06-21 03:14:47 -    📊 總記錄: 26
2025-06-21 03:14:47 -    ✅ 有效差異: 5
2025-06-21 03:14:47 -    ⚪ NULL差異: 21
2025-06-21 03:14:47 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00
2025-06-21 03:14:47 - 💾 開始保存 26 條差異數據...
2025-06-21 03:14:47 - 📊 NULL值統計: {'funding_rate_a': np.int64(21), 'funding_rate_b': np.int64(23), 'diff_ab': np.int64(21)}
2025-06-21 03:14:47 - ✅ 自定義插入完成: 26 條記錄
2025-06-21 03:14:47 - ✅ 成功保存 26 條差異數據
2025-06-21 03:14:47 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 26 條
2025-06-21 03:14:47 - ============================================================
2025-06-21 03:14:47 - 🎉 V3版本處理完成！總共處理 26 條記錄
2025-06-21 03:14:47 - ============================================================
2025-06-21 03:15:40 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:15:40 - ============================================================
2025-06-21 03:15:40 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:15:40 - ============================================================
2025-06-21 03:15:40 - 參數: symbol=None
2025-06-21 03:15:40 - 日期: None ~ None
2025-06-21 03:15:40 - 交易所: ['binance', 'bybit']
2025-06-21 03:15:40 - 強制全量: False
2025-06-21 03:15:40 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:15:40 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 03:15:40 - 📊 來源數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00 (13 條)
2025-06-21 03:15:40 - 📊 結果數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00 (26 條)
2025-06-21 03:15:40 - 📊 添加新數據範圍: 2024-05-03 ~ 2024-05-02
2025-06-21 03:15:40 - 🔄 處理範圍: 2024-05-03 ~ 2024-05-02
2025-06-21 03:15:40 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:15:40 - ⚠️ 未找到符合條件的歷史數據
2025-06-21 03:15:40 - ⚠️ 範圍 2024-05-03 ~ 2024-05-02 沒有數據
2025-06-21 03:15:40 - ============================================================
2025-06-21 03:15:40 - 🎉 V3版本處理完成！總共處理 0 條記錄
2025-06-21 03:15:40 - ============================================================
2025-06-21 03:16:03 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:16:03 - ============================================================
2025-06-21 03:16:03 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:16:03 - ============================================================
2025-06-21 03:16:03 - 參數: symbol=None
2025-06-21 03:16:03 - 日期: None ~ None
2025-06-21 03:16:03 - 交易所: ['binance', 'bybit']
2025-06-21 03:16:03 - 強制全量: False
2025-06-21 03:16:03 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:16:03 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 03:16:03 - 📊 來源數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00 (13 條)
2025-06-21 03:16:03 - 📊 結果數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 00:00:00 (26 條)
2025-06-21 03:16:03 - 📊 添加新數據範圍: 2024-05-02 01:00:00 ~ 2024-05-02 02:00:00 (查詢範圍: 2024-05-02 ~ 2024-05-02)
2025-06-21 03:16:03 - 🔄 處理範圍: 2024-05-02 ~ 2024-05-02
2025-06-21 03:16:03 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:16:03 - ✅ 獲取到 7 條歷史數據
2025-06-21 03:16:03 -    📅 時間範圍: 2024-05-02 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:16:03 -    🔗 交易對: 2
2025-06-21 03:16:03 -    🏢 交易所: 2
2025-06-21 03:16:03 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:16:03 - 📊 輸入數據: 7 條記錄
2025-06-21 03:16:03 - 🔗 交易對數量: 2
2025-06-21 03:16:03 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:16:03 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:16:03 - ✅ BTC/USDT: 計算完成 3 條差異記錄
2025-06-21 03:16:03 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:16:03 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:16:03 - ✅ V3計算完成!
2025-06-21 03:16:03 -    📊 總記錄: 4
2025-06-21 03:16:03 -    ✅ 有效差異: 4
2025-06-21 03:16:03 -    ⚪ NULL差異: 0
2025-06-21 03:16:03 -    📅 時間範圍: 2024-05-02 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:16:03 - 💾 開始保存 4 條差異數據...
2025-06-21 03:16:03 - 📊 NULL值統計: {'funding_rate_a': np.int64(0), 'funding_rate_b': np.int64(1), 'diff_ab': np.int64(0)}
2025-06-21 03:16:03 - ✅ 自定義插入完成: 4 條記錄
2025-06-21 03:16:03 - ✅ 成功保存 4 條差異數據
2025-06-21 03:16:03 - ✅ 範圍 2024-05-02 ~ 2024-05-02 處理完成: 4 條
2025-06-21 03:16:03 - ============================================================
2025-06-21 03:16:03 - 🎉 V3版本處理完成！總共處理 4 條記錄
2025-06-21 03:16:03 - ============================================================
2025-06-21 03:18:18 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:18:18 - ============================================================
2025-06-21 03:18:18 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:18:18 - ============================================================
2025-06-21 03:18:18 - 參數: symbol=None
2025-06-21 03:18:18 - 日期: None ~ None
2025-06-21 03:18:18 - 交易所: ['binance', 'bybit']
2025-06-21 03:18:18 - 強制全量: False
2025-06-21 03:18:18 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:18:18 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 03:18:18 - 📊 來源數據範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00 (13 條)
2025-06-21 03:18:18 - 📊 結果數據範圍: None ~ None (0 條)
2025-06-21 03:18:18 - 📝 結果數據為空，將處理全部來源數據
2025-06-21 03:18:18 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:18:18 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:18:18 - ✅ 獲取到 12 條歷史數據
2025-06-21 03:18:18 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:18:18 -    🔗 交易對: 2
2025-06-21 03:18:18 -    🏢 交易所: 2
2025-06-21 03:18:18 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:18:18 - 📊 輸入數據: 12 條記錄
2025-06-21 03:18:18 - 🔗 交易對數量: 2
2025-06-21 03:18:18 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:18:18 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:18:18 - ✅ BTC/USDT: 計算完成 27 條差異記錄
2025-06-21 03:18:18 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:18:18 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:18:18 - ✅ V3計算完成!
2025-06-21 03:18:18 -    📊 總記錄: 28
2025-06-21 03:18:18 -    ✅ 有效差異: 7
2025-06-21 03:18:18 -    ⚪ NULL差異: 21
2025-06-21 03:18:18 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:18:18 - 💾 開始保存 28 條差異數據...
2025-06-21 03:18:18 - 📊 NULL值統計: {'funding_rate_a': np.int64(21), 'funding_rate_b': np.int64(24), 'diff_ab': np.int64(21)}
2025-06-21 03:18:18 - ✅ 自定義插入完成: 28 條記錄
2025-06-21 03:18:18 - ✅ 成功保存 28 條差異數據
2025-06-21 03:18:18 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 28 條
2025-06-21 03:18:18 - ============================================================
2025-06-21 03:18:18 - 🎉 V3版本處理完成！總共處理 28 條記錄
2025-06-21 03:18:18 - ============================================================
2025-06-21 03:24:20 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 03:24:20 - ============================================================
2025-06-21 03:24:20 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 03:24:20 - ============================================================
2025-06-21 03:24:20 - 參數: symbol=None
2025-06-21 03:24:20 - 日期: None ~ None
2025-06-21 03:24:20 - 交易所: ['binance', 'bybit']
2025-06-21 03:24:20 - 強制全量: True
2025-06-21 03:24:20 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 03:24:20 - 🔄 處理範圍: 2024-05-01 ~ 2024-05-02
2025-06-21 03:24:20 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 03:24:20 - ✅ 獲取到 12 條歷史數據
2025-06-21 03:24:20 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:24:20 -    🔗 交易對: 2
2025-06-21 03:24:20 -    🏢 交易所: 2
2025-06-21 03:24:20 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 03:24:20 - 📊 輸入數據: 12 條記錄
2025-06-21 03:24:20 - 🔗 交易對數量: 2
2025-06-21 03:24:20 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 03:24:20 - 📈 處理交易對 1/2: BTC/USDT
2025-06-21 03:24:20 - ✅ BTC/USDT: 計算完成 27 條差異記錄
2025-06-21 03:24:20 - 📈 處理交易對 2/2: ETH/USDT
2025-06-21 03:24:20 - ✅ ETH/USDT: 計算完成 1 條差異記錄
2025-06-21 03:24:20 - ✅ V3計算完成!
2025-06-21 03:24:20 -    📊 總記錄: 28
2025-06-21 03:24:20 -    ✅ 有效差異: 7
2025-06-21 03:24:20 -    ⚪ NULL差異: 21
2025-06-21 03:24:20 -    📅 時間範圍: 2024-05-01 00:00:00 ~ 2024-05-02 02:00:00
2025-06-21 03:24:20 - 💾 開始保存 28 條差異數據...
2025-06-21 03:24:20 - 📊 NULL值統計: {'funding_rate_a': np.int64(21), 'funding_rate_b': np.int64(24), 'diff_ab': np.int64(21)}
2025-06-21 03:24:20 - ✅ 自定義插入完成: 28 條記錄
2025-06-21 03:24:20 - ✅ 成功保存 28 條差異數據
2025-06-21 03:24:20 - ✅ 範圍 2024-05-01 ~ 2024-05-02 處理完成: 28 條
2025-06-21 03:24:20 - ============================================================
2025-06-21 03:24:20 - 🎉 V3版本處理完成！總共處理 28 條記錄
2025-06-21 03:24:20 - ============================================================
2025-06-21 04:22:58 - 🚀 資金費率差異計算程式啟動 (V3版本)
2025-06-21 04:22:58 - ============================================================
2025-06-21 04:22:58 - 📅 資金費率差異計算 V3 (Pandas優化版本)
2025-06-21 04:22:58 - ============================================================
2025-06-21 04:22:58 - 參數: symbol=None
2025-06-21 04:22:58 - 日期: None ~ None
2025-06-21 04:22:58 - 交易所: ['binance', 'bybit']
2025-06-21 04:22:58 - 強制全量: False
2025-06-21 04:22:58 - 將計算以下交易所對的差異: [('binance', 'bybit')]
2025-06-21 04:22:58 - 🔍 分析數據範圍，計算處理策略...
2025-06-21 04:22:58 - 📊 來源數據範圍: 2024-06-01 00:00:00 ~ 2024-06-01 04:00:00 (6 條)
2025-06-21 04:22:58 - 📊 結果數據範圍: None ~ None (0 條)
2025-06-21 04:22:58 - 📝 結果數據為空，將處理全部來源數據
2025-06-21 04:22:58 - 🔄 處理範圍: 2024-06-01 ~ 2024-06-01
2025-06-21 04:22:58 - 🔍 查詢資金費率歷史數據: 4 個參數
2025-06-21 04:22:58 - ✅ 獲取到 6 條歷史數據
2025-06-21 04:22:58 -    📅 時間範圍: 2024-06-01 00:00:00 ~ 2024-06-01 04:00:00
2025-06-21 04:22:58 -    🔗 交易對: 1
2025-06-21 04:22:58 -    🏢 交易所: 2
2025-06-21 04:22:58 - 🚀 V3版本：開始Pandas差異計算...
2025-06-21 04:22:58 - 📊 輸入數據: 6 條記錄
2025-06-21 04:22:58 - 🔗 交易對數量: 1
2025-06-21 04:22:58 - 🏢 交易所對: [('binance', 'bybit')]
2025-06-21 04:22:58 - 📈 處理交易對 1/1: TEST/USDT
2025-06-21 04:22:58 - ✅ TEST/USDT: 計算完成 5 條差異記錄
2025-06-21 04:22:58 - ✅ V3計算完成!
2025-06-21 04:22:58 -    📊 總記錄: 5
2025-06-21 04:22:58 -    ✅ 有效差異: 4
2025-06-21 04:22:58 -    ⚪ NULL差異: 1
2025-06-21 04:22:58 -    📅 時間範圍: 2024-06-01 00:00:00 ~ 2024-06-01 04:00:00
2025-06-21 04:22:58 - 💾 開始保存 5 條差異數據...
2025-06-21 04:22:58 - 📊 NULL值統計: {'funding_rate_a': np.int64(2), 'funding_rate_b': np.int64(2), 'diff_ab': np.int64(1)}
2025-06-21 04:22:58 - ✅ 自定義插入完成: 5 條記錄
2025-06-21 04:22:58 - ✅ 成功保存 5 條差異數據
2025-06-21 04:22:58 - ✅ 範圍 2024-06-01 ~ 2024-06-01 處理完成: 5 條
2025-06-21 04:22:58 - ============================================================
2025-06-21 04:22:58 - 🎉 V3版本處理完成！總共處理 5 條記錄
2025-06-21 04:22:58 - ============================================================
